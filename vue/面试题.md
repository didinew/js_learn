1️⃣ 为什么不推荐 watch 同步 props？

✅ 一句话结论

watch 同步 props = 破坏单向数据流 + 制造双源状态（Two Sources of Truth）

⸻

🔍 本质原因

props → watch → localState

你实际上在做一件事：

把“父状态”复制成“子状态”

这会导致：

问题
解释
❌ 状态不同步
父改了，子没及时跟
❌ 更新路径不清晰
到底该改 props 还是 local？
❌ watch 是副作用
watch 本来就不是“建模工具”
❌ 隐性 bug
多个 watch / 初始化顺序问题


⸻

❌ 错误示例（高频事故）
const localValue = ref(props.value)

watch(() => props.value, v => {
  localValue.value = v
})

看似安全，实际上是“手动同步系统”

⸻

✅ 正确心智模型

场景
正解
只展示
直接用 props
需要变更
emit 给父组件
需要加工
computed(props → 派生)
只在初始化用一次
const local = ref(props.xxx)（无 watch）


⸻

🎯 面试反杀

“watch 同步 props 本质是把单向数据流改成双向镜像，这是反模式。”

⸻

⸻

2️⃣ Suspense 为什么不管 mounted？

✅ 一句话结论

Suspense 控制的是「渲染时机」，而 mounted 是「组件生命周期」

⸻

🧠 真正的渲染流程

setup()
 └─ async setup / async component
     └─ Suspense fallback
         └─ resolve 完成
             └─ patch DOM
                 └─ mounted

🔴 关键点：

mounted 只会在“真实 DOM 挂载完成后”才触发

而 Suspense 做的是：
	•	等待 async setup / async component
	•	决定 什么时候允许渲染

👉 它发生在 mounted 之前

⸻

❌ 为什么不能用 mounted 控制加载态？

mounted
Suspense
已经渲染完
决定是否渲染
太晚了
正确时机
只能处理副作用
管渲染分支


⸻

🎯 面试反杀

“Suspense 是渲染调度器，不是生命周期钩子。”

⸻

⸻

3️⃣ 什么时候状态必须提升（Lifting State Up）？

✅ 一句话结论

当多个组件“需要对同一状态达成一致”时，状态必须上移

⸻

🔥 必须提升的 3 个硬条件

① 多个子组件依赖同一状态
Filter → List → Summary

② 子组件之间需要“相互影响”
A 改 → B 必须同步响应

③ 状态是“业务事实（Single Source of Truth）”
当前用户 / 当前选中项 / 当前步骤

⸻

❌ 不需要提升的

类型
例子
纯 UI
hover / focus / 展开收起
临时状态
loading / dragging
不可复用
只影响自身



⸻

🎯 面试反杀

“状态是否提升，取决于‘一致性需求’，不是组件层级。”

⸻

⸻

4️⃣ Store 和组件状态的边界在哪里？

✅ 一句话结论

Store 管“跨组件 + 跨页面 + 可恢复”的状态

⸻

📊 清晰分界表

维度
Store
Component
生命周期
跨页面
随组件
作用域
全局/模块
局部
业务重要性
核心业务态
UI 细节
可复用
高
低
可持久化
是
否


⸻

🔥 应进 Store 的状态
	•	登录用户
	•	权限 / Token
	•	购物车
	•	当前比赛 / 当前订单
	•	WebSocket 推送数据（你项目里就有）

⸻

❌ 不该进 Store 的
	•	modal 是否打开
	•	hover 状态
	•	表单输入中间态
	•	动画状态

⸻

🎯 面试反杀

“进 Store 的不是‘想共享’，而是‘必须稳定存在’。”

⸻

⸻

5️⃣ 受控组件最大的价值是什么？

✅ 一句话结论

受控组件的本质是：把状态控制权还给业务，而不是组件自己

⸻

🧠 非受控 vs 受控



非受控
受控
状态
内部维护
父控制
可预测性
低
高
联动能力
弱
强
表单校验
难
易
业务组合
差
强



⸻

🔥 真正的价值（不是“v-model”）
	1.	状态唯一来源
	2.	行为可追踪
	3.	易做校验 / 回滚 / 重放
	4.	组件可组合（Headless 思维）

⸻

🎯 面试反杀

“受控组件解决的不是‘输入’，而是‘业务可控性’。”

⸻

🧠 总结一句话（高阶）

Vue 高阶不是 API，而是“状态在哪里、谁说了算、谁负责一致性”。


