ğŸŸ¢ Day 2ï¼šref / reactive / toRefs æ·±æ°´åŒº

â¸»

ä¸€ã€å…ˆç»™ä½ ç»“è®ºï¼ˆå…ˆç«‹ç»“è®ºï¼‰

Vue3 çš„å“åº”å¼ä¸æ˜¯â€œå˜é‡å“åº”â€ï¼Œè€Œæ˜¯â€œå¯¹è±¡å±æ€§å“åº”â€

è¿™å¥è¯ï¼Œä»Šå¤©æ‰€æœ‰é—®é¢˜éƒ½ä»è¿™é‡Œå‡ºå‘ã€‚

â¸»

äºŒã€reactive æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ

const state = reactive({ count: 0 })

æœ¬è´¨æ˜¯ï¼š

Proxy ä»£ç†çš„æ˜¯æ•´ä¸ªå¯¹è±¡çš„â€œå±æ€§è®¿é—®â€

state.count  // âœ” è§¦å‘ get â†’ track

ğŸ“Œ å…³é”®ç‚¹ï¼š
	â€¢	ä¾èµ–æ˜¯æ”¶é›†åœ¨ state.count
	â€¢	è€Œä¸æ˜¯ count è¿™ä¸ªå˜é‡

â¸»

ä¸‰ã€ref æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆé¢è¯•å®˜æœ€çˆ±ï¼‰

const count = ref(0)
æœ¬è´¨ç»“æ„ï¼š

{
  value: 0
}
ğŸ“Œ Vue å®é™…åšçš„æ˜¯ï¼š

reactive({ value: 0 })

ğŸ‘‰ æ‰€ä»¥ï¼š

count.value  // âœ” å“åº”å¼


â¸»

å››ã€ä¸ºä»€ä¹ˆ reactive è§£æ„å¿…ç‚¸ï¼Ÿ

âŒ é”™è¯¯å†™æ³•ï¼ˆ99% æ–°æ‰‹è¸©ï¼‰

const state = reactive({ count: 0 })
const { count } = state

count++   // âŒ è§†å›¾ä¸æ›´æ–°

ğŸ”¥ çœŸæ­£åŸå› ï¼ˆå¿…é¡»ä¼šè®²ï¼‰

è§£æ„æ‹¿åˆ°çš„æ˜¯â€œå€¼â€ï¼Œä¸æ˜¯ Proxy çš„ get è¡Œä¸º

ç­‰ä»·äºï¼š

const count = state.count  // æ™®é€šå€¼
ğŸ“Œ æ­¤æ—¶ï¼š
	â€¢	æ²¡æœ‰ Proxy
	â€¢	æ²¡æœ‰ track
	â€¢	æ²¡æœ‰ trigger

â¸»

äº”ã€é‚£ä¸ºä»€ä¹ˆ ref è§£æ„æ²¡äº‹ï¼Ÿ

const count = ref(0)
const { value } = count

âŒ å…¶å®ä¹Ÿç‚¸ï¼

value++  // âŒ ä¸å“åº”

ğŸ“Œ çœŸç›¸ï¼š

ref è§£æ„åªæœ‰åœ¨ æ¨¡æ¿é‡Œ ä¸ç‚¸
æ˜¯å› ä¸º Vue ç¼–è¯‘é˜¶æ®µè‡ªåŠ¨ .value å¤„ç†

â¸»

å…­ã€toRefs / toRef æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆæ•‘å‘½å·¥å…·ï¼‰

toRefsï¼ˆæ‰¹é‡ä¿å“åº”ï¼‰

const state = reactive({ count: 0, name: 'vue' })
const { count, name } = toRefs(state)
ç­‰ä»·äºï¼š
count.value â†â†’ state.count
ğŸ“Œ æœ¬è´¨ï¼š
	â€¢	æ¯ä¸ª key åŒ…ä¸€å±‚ ref
	â€¢	å¼•ç”¨åŒä¸€å“åº”å¼æº

â¸»

toRefï¼ˆå•ä¸ªå­—æ®µï¼‰

â¸»

ä¸ƒã€ä»€ä¹ˆæ—¶å€™ç”¨ reactiveï¼Ÿä»€ä¹ˆæ—¶å€™ç”¨ refï¼Ÿ

âœ… æ¨èä½¿ç”¨åŸåˆ™ï¼ˆé«˜çº§ï¼‰

åœºæ™¯
æ¨è
å¯¹è±¡ / è¡¨å• / çŠ¶æ€é›†
reactive
åŸºæœ¬ç±»å‹
ref
ç»„ä»¶ props å•å­—æ®µ
toRef
store çŠ¶æ€
reactive + toRefs

ğŸ“Œ ä¸è¦ä¸ºäº†â€œç»Ÿä¸€é£æ ¼â€æ»¥ç”¨ ref


â¸»

å…«ã€ä¸€ä¸ªâ€œé«˜çº§ä½†å¸¸è§â€çš„å‘

const state = reactive({ list: [] })
state.list = []   // âœ” å“åº”

const list = ref([])
list.value = []  // âœ” å“åº”

ğŸ“Œ ref æ›¿æ¢æ•´ä¸ªå€¼æ²¡é—®é¢˜
reactive æ›¿æ¢å¯¹è±¡æ‰å®‰å…¨

â¸»

ä¹ã€Day 2 é¢è¯•æ ‡å‡†ç­”æ¡ˆï¼ˆç›´æ¥èƒŒï¼‰

ä¸ºä»€ä¹ˆ reactive è§£æ„åä¸å“åº”ï¼Ÿ

âœ… æ»¡åˆ†å›ç­”ï¼š

Vue3 çš„å“åº”å¼æ˜¯åŸºäº Proxy å¯¹å¯¹è±¡å±æ€§è¿›è¡Œæ‹¦æˆªçš„ï¼Œè§£æ„ä¼šåœ¨åˆå§‹åŒ–æ—¶ç›´æ¥è¯»å–å±æ€§å€¼ï¼Œç»•è¿‡äº† Proxy çš„ get/setï¼Œå› æ­¤å¤±å»äº†ä¾èµ–æ”¶é›†å’Œè§¦å‘èƒ½åŠ›ã€‚è¦ä¿æŒå“åº”å¼ï¼Œéœ€è¦ä½¿ç”¨ toRefs æˆ– toRef å»ºç«‹å¼•ç”¨å…³ç³»ã€‚



