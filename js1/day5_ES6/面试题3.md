
â¸»

ğŸ’£ React props è§£æ„ã€Œå¿…ç‚¸å‘ã€ï¼ˆçœŸå®æºç çº§ï¼‰

â“ é¢˜ç›®

ä¸‹é¢è¿™ä¸ª React ç»„ä»¶æœ‰æ²¡æœ‰é—®é¢˜ï¼Ÿ
function UserCard({ user: { name, age } }) {
  return (
    <div>
      <p>{name}</p>
      <p>{age}</p>
    </div>
  );
}


â¸»

âŒ 90% çš„å›ç­”

â€œæ²¡é—®é¢˜å•Šï¼Œè§£æ„ propsâ€

ğŸ‘‰ ç›´æ¥æŒ‚

â¸»

ğŸ’¥ çœŸå®ç‚¸ç‚¹

å½“ç»„ä»¶è¿™æ ·ç”¨æ—¶ï¼š

<UserCard />

æˆ–ï¼š

<UserCard user={null} />

ğŸ’£ ç›´æ¥æŠ¥é”™
TypeError: Cannot destructure property 'name' of 'undefined'
TypeError: Cannot destructure property 'name' of 'null'


â¸»

ğŸ§  åŸå› ï¼ˆé¢è¯•å®˜æƒ³å¬ï¼‰

React ä¸ä¼šä¿è¯ props å­˜åœ¨ï¼š

props.user === undefined | null

è€Œå‚æ•°è§£æ„æ˜¯åŒæ­¥ç«‹å³æ‰§è¡Œçš„ï¼Œ
é”™è¯¯å‘ç”Ÿåœ¨å‡½æ•°ä½“æ‰§è¡Œå‰ï¼ŒReact æ ¹æœ¬æ•‘ä¸äº†ä½ ã€‚

â¸»

âŒ é”™è¯¯çš„â€œçœ‹ä¼¼ä¿®å¤â€

function UserCard({ user = {} }) {
  const { name, age } = user;
}

âš ï¸ ä»ç„¶æœ‰å‘

<UserCard user={null} />

âŒ null ä¸ä¼šè§¦å‘é»˜è®¤å€¼

â¸»

âœ… æ­£ç¡® & å·¥ç¨‹çº§å†™æ³•ï¼ˆæ¨èï¼‰

âœ… å†™æ³• 1ï¼šå‚æ•°å…œåº• + å¯é€‰é“¾ï¼ˆæœ€å®‰å…¨ï¼‰

function UserCard({ user } = {}) {
  const name = user?.name ?? '-';
  const age = user?.age ?? '-';

  return (
    <div>
      <p>{name}</p>
      <p>{age}</p>
    </div>
  );
}


â¸»

âœ… å†™æ³• 2ï¼šåˆ†å±‚è§£æ„ï¼ˆReact å®˜æ–¹æ›´æ¨èï¼‰

function UserCard(props) {
  const { user } = props || {};
  const { name, age } = user || {};

  return (
    <div>
      <p>{name}</p>
      <p>{age}</p>
    </div>
  );
}

ğŸ“Œ å¯è¯»æ€§ > ç‚«æŠ€


â¸»

ğŸ”¥ æ›´ç‹ çš„éšè—å‘ï¼ˆé«˜é¢‘ç¿»è½¦ï¼‰

â“ å†çœ‹è¿™ä¸ªç»„ä»¶ï¼Œæœ‰æ²¡æœ‰é—®é¢˜ï¼Ÿ

function Button({ onClick = () => {} }) {
  return <button onClick={onClick}>Click</button>;
}

âŒ éšå½¢æ€§èƒ½ Bug
	â€¢	æ¯æ¬¡ render éƒ½åˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°
	â€¢	ç ´å memo / PureComponent

â¸»

âœ… æ­£ç¡®å†™æ³•
const noop = () => {};

function Button({ onClick = noop }) {
  return <button onClick={onClick}>Click</button>;
}

ğŸ‘‰ è¿™æ˜¯çœŸå® React æºç çº§å†™æ³•

â¸»

ğŸ§¨ å†ä¸€ä¸ª React æºç çº§å‘ï¼ˆchildrenï¼‰

function List({ children }) {
  return children.map(item => <li>{item}</li>);
}

ğŸ’¥ ç‚¸ç‚¹
<List>hello</List>
âŒ children å¯èƒ½ä¸æ˜¯æ•°ç»„


â¸»

âœ… æ­£ç¡®å†™æ³•

function List({ children }) {
  return React.Children.map(children, item => <li>{item}</li>);
}


â¸»

ğŸ¯ é¢è¯•å®˜çœŸå®è€ƒç‚¹æ€»ç»“

è€ƒç‚¹
æ˜¯å¦å‘½ä¸­
props ä¸å¯ä¿¡
âœ…
å‚æ•°è§£æ„æ‰§è¡Œæ—¶æœº
âœ…
null vs undefined
âœ…
æ€§èƒ½æ„è¯†
âœ…
children å¤šæ€æ€§
âœ…


ğŸ§  é¢è¯•å®˜ç»ˆæè¿½é—®ï¼ˆå°ç¥ï¼‰

é‚£ä¸ºä»€ä¹ˆ React å®˜æ–¹æ–‡æ¡£è¿˜å¤§é‡ä½¿ç”¨ props è§£æ„ï¼Ÿ

æ»¡åˆ†å›ç­”

å› ä¸ºåœ¨å¯æ§çš„ç»„ä»¶è¾¹ç•Œå†…è§£æ„æ˜¯å®‰å…¨çš„ï¼Œä½†åœ¨å…¬å…±ç»„ä»¶æˆ–ä¸šåŠ¡ç»„ä»¶ä¸­å¿…é¡»è€ƒè™‘å¼‚å¸¸è¾“å…¥ï¼Œé¿å…åœ¨å‚æ•°é˜¶æ®µåšæ·±å±‚è§£æ„ã€‚

â¸»

ğŸ“Œ ä¸€å¥è¯å°ç¥ï¼ˆèƒŒï¼‰

åœ¨ React ä¸­ï¼Œprops æ°¸è¿œä¸å¯ä¿¡ï¼Œå‡½æ•°å‚æ•°é˜¶æ®µçš„æ·±å±‚è§£æ„æ˜¯æ½œåœ¨çš„è¿è¡Œæ—¶ç‚¸å¼¹ã€‚


