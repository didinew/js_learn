你答题时只记一句话：

## 同步 → 微任务 → 宏任务

① await vs Promise.then 谁先执行？
async function f() {

```js
await Promise.resolve();
console.log("await");
```

}

Promise.resolve().then(() => console.log('then'))

f()

✅ 输出：
then

```js
await

```

核心原因（标准答案）

## 微任务按注册顺序执行，then 先注册，await 后注册

② await 会不会阻塞渲染？
async function f() {

```js
await new Promise((r) => setTimeout(r, 3000));
console.log("done");
```

}
f()
结论（必背）

不会阻塞主线程，也不会阻塞页面渲染

面试官想听

```js
await 只是暂停当前 async 函数，JS 线程仍然可以执行渲染、事件响应。
```

---

③ await setTimeout 为什么“失效”？

```js
await setTimeout(() => {}, 1000);
```

## 结论

setTimeout 不返回 Promise

## 正确写法

```js
await new Promise((r) => setTimeout(r, 1000));
```

---

④ await 放在 if / try 里有区别吗？
async function f() {

```js
if (true) {
await Promise.resolve()
```

}

```js
console.log(1);
```

}

## 结论

只要执行到 await，后面一定异步

## 结构位置无关。

⑤ await + return 谁先？

async function f() {

```js
return await Promise.resolve(1);
```

}

## 结论

等 Promise resolve 后再 return

追问必杀

```js
return await 多此一举吗？

```

## ✅ 在 try/catch 中不是多余的

⑥ try/catch 能抓住哪些错误？
async function f() {
try {

```js
await Promise.reject("err");
```

} catch(e) {

```js
console.log(e);
```

}
}

## 结论

```js
await 能把 Promise 的 reject 转成同步 throw

```

但：
setTimeout(() => { throw 'err' })
❌ 抓不到

---

⑦ await vs Promise.all 错误处理差异（高频）

```js
await Promise.all([
```

Promise.resolve(1),
Promise.reject('err')
])

## 结论

有一个 reject，整体直接 reject

面试追问

有没有“部分成功”的写法？

```js
Promise.allSettled();
```

---

⑧ await 会不会打断函数执行栈？

## 答案

会清空当前调用栈

## 这是为什么 await 后的代码永远异步。

⑨ 微任务一定在宏任务前执行吗？

## 结论

当前宏任务结束后，清空所有微任务

执行顺序：
宏任务 → 微任务 → 渲染 → 下一个宏任务

---

⑩ 地狱级终极题（一定会被问）

```js
console.log(1);
```

async function f() {

```js
console.log(2);
await Promise.resolve();
console.log(3);
```

}

setTimeout(() => console.log(4))

f()

Promise.resolve().then(() => console.log(5))

```js
console.log(6);
```

| 正确输出 | 1 |
| --- | --- |
| 2 | 6 |
| 3 | 5 |
| 4 | 面试标准拆解 1. 同步：1 → 2 → 6 2. 微任务（注册顺序）：3 → 5 3. 宏任务：4 |
---

面试官终局评价级总结

async/await 不会阻塞线程，await 会把后续代码放进微任务队列，微任务优先于宏任务执行，Promise.all 任一失败整体失败，async 函数始终返回 Promise。
